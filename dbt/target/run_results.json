{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2026-02-04T13:15:34.663124Z", "invocation_id": "31729f79-7e43-48c5-9821-7a33cebe0c74", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:33.790551Z", "completed_at": "2026-02-04T13:15:33.819031Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:33.820607Z", "completed_at": "2026-02-04T13:15:33.820640Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03268933296203613, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.silver_ecommerce_events", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT *\n    FROM bronze.ecommerce_events\n    \n    \n    -- Only process new data\n    WHERE _ingestion_time > (SELECT MAX(_bronze_ingestion_time) FROM silver.silver_ecommerce_events)\n    \n),\n\ncleaned_events AS (\n    SELECT\n        -- Generate unique ID\n        MD5(CONCAT(\n            CAST(user_id AS STRING),\n            COALESCE(CAST(product_id AS STRING), 'NULL'),\n            event_type,\n            event_time\n        )) AS event_unique_id,\n        \n        -- Parse timestamp\n        CAST(event_time AS TIMESTAMP) AS event_timestamp,\n        DATE(CAST(event_time AS TIMESTAMP)) AS event_date,\n        HOUR(CAST(event_time AS TIMESTAMP)) AS event_hour,\n        DAYOFWEEK(CAST(event_time AS TIMESTAMP)) AS day_of_week_num,\n        \n        -- Clean event type\n        LOWER(TRIM(event_type)) AS event_type,\n        \n        -- IDs (user_id required, product_id nullable)\n        user_id,\n        TRIM(user_session) AS user_session,\n        product_id,  -- Nullable OK\n        \n        -- Parse category hierarchy\n        CASE \n            WHEN category_code IS NOT NULL THEN SPLIT(category_code, '\\\\.')[0]\n            ELSE NULL \n        END AS category_level_1,\n        \n        CASE \n            WHEN category_code IS NOT NULL AND SIZE(SPLIT(category_code, '\\\\.')) >= 2 \n            THEN SPLIT(category_code, '\\\\.')[1]\n            ELSE NULL \n        END AS category_level_2,\n        \n        CASE \n            WHEN category_code IS NOT NULL AND SIZE(SPLIT(category_code, '\\\\.')) >= 3 \n            THEN SPLIT(category_code, '\\\\.')[2]\n            ELSE NULL \n        END AS category_level_3,\n        \n        -- Standardize brand\n        CASE \n            WHEN brand IS NOT NULL THEN UPPER(TRIM(brand))\n            ELSE NULL \n        END AS brand_standardized,\n        \n        -- Price validation\n        CASE \n            WHEN price IS NULL THEN NULL\n            WHEN price < 0 THEN NULL  -- Invalid prices \u2192 NULL\n            ELSE ROUND(price, 2)\n        END AS price_clean,\n        \n        -- Derived: Price bucket\n        CASE \n            WHEN price IS NULL THEN 'UNKNOWN'\n            WHEN price < 50 THEN '0-50'\n            WHEN price < 100 THEN '50-100'\n            WHEN price < 200 THEN '100-200'\n            WHEN price < 500 THEN '200-500'\n            ELSE '500+'\n        END AS price_bucket,\n        \n        -- Derived: Time of day\n        CASE \n            WHEN HOUR(CAST(event_time AS TIMESTAMP)) >= 6 AND HOUR(CAST(event_time AS TIMESTAMP)) < 12 THEN 'MORNING'\n            WHEN HOUR(CAST(event_time AS TIMESTAMP)) >= 12 AND HOUR(CAST(event_time AS TIMESTAMP)) < 18 THEN 'AFTERNOON'\n            WHEN HOUR(CAST(event_time AS TIMESTAMP)) >= 18 AND HOUR(CAST(event_time AS TIMESTAMP)) < 22 THEN 'EVENING'\n            ELSE 'NIGHT'\n        END AS time_of_day,\n        \n        -- Derived: Is weekend\n        CASE \n            WHEN DAYOFWEEK(CAST(event_time AS TIMESTAMP)) IN (1, 7) THEN TRUE  -- Sunday=1, Saturday=7\n            ELSE FALSE \n        END AS is_weekend,\n        \n        -- Metadata\n        _ingestion_time AS _bronze_ingestion_time,\n        _source_file,\n        CURRENT_TIMESTAMP() AS _silver_processed_at,\n        _processing_date\n        \n    FROM source_data\n    WHERE user_id IS NOT NULL  -- User ID is required\n),\n\n-- Remove duplicates\ndeduped_events AS (\n    SELECT *\n    FROM (\n        SELECT \n            *,\n            ROW_NUMBER() OVER (\n                PARTITION BY event_unique_id \n                ORDER BY _bronze_ingestion_time DESC\n            ) AS row_num\n        FROM cleaned_events\n    ) ranked\n    WHERE row_num = 1\n)\n\nSELECT\n    event_unique_id,\n    event_timestamp,\n    event_date,\n    event_hour,\n    day_of_week_num,\n    \n    event_type,\n    user_id,\n    user_session,\n    product_id,\n    \n    category_level_1,\n    category_level_2,\n    category_level_3,\n    \n    brand_standardized AS brand,\n    price_clean AS price,\n    price_bucket,\n    \n    time_of_day,\n    is_weekend,\n    \n    _bronze_ingestion_time,\n    _source_file,\n    _silver_processed_at,\n    _processing_date\n    \nFROM deduped_events", "relation_name": "silver.silver_ecommerce_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:33.828116Z", "completed_at": "2026-02-04T13:15:33.872457Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:33.874123Z", "completed_at": "2026-02-04T13:15:33.874148Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04932427406311035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.source_accepted_values_bronze_ecommerce_events_event_type__view__cart__purchase__remove_from_cart.d8a9c52576", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_type as value_field,\n        count(*) as n_records\n\n    from bronze.ecommerce_events\n    group by event_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'view','cart','purchase','remove_from_cart'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:33.879392Z", "completed_at": "2026-02-04T13:15:33.900267Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:33.901653Z", "completed_at": "2026-02-04T13:15:33.901677Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024914026260375977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.source_not_null_bronze_ecommerce_events__processing_date.af290b32ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _processing_date\nfrom bronze.ecommerce_events\nwhere _processing_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:33.906655Z", "completed_at": "2026-02-04T13:15:33.920583Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:33.921969Z", "completed_at": "2026-02-04T13:15:33.921992Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018097400665283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.source_not_null_bronze_ecommerce_events_event_time.c9bca3180f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_time\nfrom bronze.ecommerce_events\nwhere event_time is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:33.926340Z", "completed_at": "2026-02-04T13:15:33.940386Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:33.941601Z", "completed_at": "2026-02-04T13:15:33.941623Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017417192459106445, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.source_not_null_bronze_ecommerce_events_event_type.b5d4004f0b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom bronze.ecommerce_events\nwhere event_type is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:33.946699Z", "completed_at": "2026-02-04T13:15:33.959832Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:33.961086Z", "completed_at": "2026-02-04T13:15:33.961107Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016449689865112305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.source_not_null_bronze_ecommerce_events_user_id.acdc2b663b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom bronze.ecommerce_events\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:33.965329Z", "completed_at": "2026-02-04T13:15:33.978631Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:33.979833Z", "completed_at": "2026-02-04T13:15:33.979854Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016597509384155273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_category_performance", "compiled": true, "compiled_code": "\n\n-- 1\ufe0f\u20e3 Daily category metrics\nWITH category_daily AS (\n    SELECT\n        event_date AS analysis_date,\n        category_level_1,\n        category_level_2,\n        \n        -- Revenue metrics\n        SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) AS total_revenue,\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS total_orders,\n        COUNT(DISTINCT CASE WHEN event_type = 'purchase' THEN user_id END) AS unique_customers,\n        \n        ROUND(\n            SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) /\n            NULLIF(COUNT(CASE WHEN event_type = 'purchase' THEN 1 END), 0),\n            2\n        ) AS avg_order_value,\n        \n        CURRENT_TIMESTAMP() AS _updated_at\n        \n    FROM silver.silver_ecommerce_events\n    WHERE category_level_1 IS NOT NULL\n    \n    \n    AND event_date > (SELECT MAX(analysis_date) FROM silver_gold.gold_category_performance)\n    \n    \n    GROUP BY event_date, category_level_1, category_level_2\n),\n\n-- 2\ufe0f\u20e3 Brand revenue per day per category\nbrand_daily_revenue AS (\n    SELECT\n        event_date AS analysis_date,\n        category_level_1,\n        category_level_2,\n        brand,\n        SUM(price) AS brand_revenue\n    FROM silver.silver_ecommerce_events\n    WHERE event_type = 'purchase'\n      AND brand IS NOT NULL\n      AND category_level_1 IS NOT NULL\n    GROUP BY event_date, category_level_1, category_level_2, brand\n),\n\n-- 3\ufe0f\u20e3 Rank brands by revenue\nranked_brands AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY analysis_date, category_level_1, category_level_2\n            ORDER BY brand_revenue DESC\n        ) AS brand_rank\n    FROM brand_daily_revenue\n),\n\n-- 4\ufe0f\u20e3 Pick top brand per category per day\ntop_brand_per_category AS (\n    SELECT\n        analysis_date,\n        category_level_1,\n        category_level_2,\n        brand AS top_brand,\n        brand_revenue AS top_brand_revenue\n    FROM ranked_brands\n    WHERE brand_rank = 1\n)\n\n-- 5\ufe0f\u20e3 Final output\nSELECT\n    cd.*,\n    tb.top_brand,\n    tb.top_brand_revenue\nFROM category_daily cd\nLEFT JOIN top_brand_per_category tb\n  ON cd.analysis_date = tb.analysis_date\n AND cd.category_level_1 = tb.category_level_1\n AND cd.category_level_2 = tb.category_level_2\nORDER BY cd.analysis_date, cd.total_revenue DESC", "relation_name": "silver_gold.gold_category_performance"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:33.984384Z", "completed_at": "2026-02-04T13:15:33.997422Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:33.998608Z", "completed_at": "2026-02-04T13:15:33.998628Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016363143920898438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_conversion_funnel_daily", "compiled": true, "compiled_code": "\n\nWITH funnel_metrics AS (\n    SELECT\n        event_date AS analysis_date,\n        category_level_1,\n        category_level_2,\n        time_of_day,\n        is_weekend,\n        \n        -- Unique users per stage\n        COUNT(DISTINCT CASE WHEN event_type = 'view' THEN user_id END) AS stage_1_view_users,\n        COUNT(DISTINCT CASE WHEN event_type = 'cart' THEN user_id END) AS stage_2_cart_users,\n        COUNT(DISTINCT CASE WHEN event_type = 'purchase' THEN user_id END) AS stage_3_purchase_users,\n        \n        -- Total events per stage\n        COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS stage_1_view_events,\n        COUNT(CASE WHEN event_type = 'cart' THEN 1 END) AS stage_2_cart_events,\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS stage_3_purchase_events,\n        \n        -- Revenue\n        SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) AS total_revenue,\n        \n        CURRENT_TIMESTAMP() AS _updated_at\n        \n    FROM silver.silver_ecommerce_events\n    \n    \n    WHERE event_date > (SELECT MAX(analysis_date) FROM silver_gold.gold_conversion_funnel_daily)\n    \n    \n    GROUP BY event_date, category_level_1, category_level_2, time_of_day, is_weekend\n),\n\nwith_rates AS (\n    SELECT\n        *,\n        \n        -- Conversion rates\n        ROUND(\n            stage_2_cart_users * 100.0 / NULLIF(stage_1_view_users, 0),\n            2\n        ) AS view_to_cart_rate,\n        \n        ROUND(\n            stage_3_purchase_users * 100.0 / NULLIF(stage_2_cart_users, 0),\n            2\n        ) AS cart_to_purchase_rate,\n        \n        ROUND(\n            stage_3_purchase_users * 100.0 / NULLIF(stage_1_view_users, 0),\n            2\n        ) AS overall_conversion_rate,\n        \n        -- Drop-offs\n        (stage_1_view_users - stage_2_cart_users) AS dropoff_after_view,\n        (stage_2_cart_users - stage_3_purchase_users) AS dropoff_after_cart,\n        \n        ROUND(\n            (stage_1_view_users - stage_2_cart_users) * 100.0 / NULLIF(stage_1_view_users, 0),\n            2\n        ) AS dropoff_rate_view,\n        \n        ROUND(\n            (stage_2_cart_users - stage_3_purchase_users) * 100.0 / NULLIF(stage_2_cart_users, 0),\n            2\n        ) AS dropoff_rate_cart,\n        \n        -- Revenue metrics\n        ROUND(\n            total_revenue / NULLIF(stage_3_purchase_users, 0),\n            2\n        ) AS avg_order_value,\n        \n        ROUND(\n            total_revenue / NULLIF(stage_1_view_users, 0),\n            2\n        ) AS revenue_per_viewer\n        \n    FROM funnel_metrics\n)\n\nSELECT * FROM with_rates\nWHERE stage_1_view_users > 0\nORDER BY analysis_date, total_revenue DESC", "relation_name": "silver_gold.gold_conversion_funnel_daily"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.003903Z", "completed_at": "2026-02-04T13:15:34.017138Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.018234Z", "completed_at": "2026-02-04T13:15:34.018250Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016345977783203125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_daily_sales_summary", "compiled": true, "compiled_code": "\n\nWITH daily_metrics AS (\n    SELECT\n        event_date AS sale_date,\n        \n        -- Revenue metrics\n        SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) AS total_revenue,\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS total_orders,\n        COUNT(DISTINCT CASE WHEN event_type = 'purchase' THEN user_id END) AS unique_customers,\n        \n        -- Average order value\n        ROUND(\n            SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) / \n            NULLIF(COUNT(CASE WHEN event_type = 'purchase' THEN 1 END), 0),\n            2\n        ) AS avg_order_value,\n        \n        -- Items purchased\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS total_items_purchased,\n        \n        -- Traffic metrics\n        COUNT(DISTINCT CASE WHEN event_type = 'view' THEN user_id END) AS unique_viewers,\n        COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS total_views,\n        COUNT(CASE WHEN event_type = 'cart' THEN 1 END) AS total_carts,\n        \n        -- Conversion rates\n        ROUND(\n            COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) * 100.0 / \n            NULLIF(COUNT(CASE WHEN event_type = 'view' THEN 1 END), 0),\n            2\n        ) AS conversion_rate,\n        \n        ROUND(\n            (COUNT(CASE WHEN event_type = 'cart' THEN 1 END) - \n             COUNT(CASE WHEN event_type = 'purchase' THEN 1 END)) * 100.0 / \n            NULLIF(COUNT(CASE WHEN event_type = 'cart' THEN 1 END), 0),\n            2\n        ) AS cart_abandonment_rate,\n        \n        CURRENT_TIMESTAMP() AS _updated_at\n        \n    FROM silver.silver_ecommerce_events\n    \n    \n    WHERE event_date > (SELECT MAX(sale_date) FROM silver_gold.gold_daily_sales_summary)\n    \n    \n    GROUP BY event_date\n)\n\nSELECT * FROM daily_metrics\nORDER BY sale_date", "relation_name": "silver_gold.gold_daily_sales_summary"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.022854Z", "completed_at": "2026-02-04T13:15:34.036543Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.039264Z", "completed_at": "2026-02-04T13:15:34.039285Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018886089324951172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_hourly_traffic", "compiled": true, "compiled_code": "\n\nWITH hourly_metrics AS (\n    SELECT\n        event_date,\n        event_hour,\n        \n        -- Day info\n        CASE day_of_week_num\n            WHEN 1 THEN 'Sunday'\n            WHEN 2 THEN 'Monday'\n            WHEN 3 THEN 'Tuesday'\n            WHEN 4 THEN 'Wednesday'\n            WHEN 5 THEN 'Thursday'\n            WHEN 6 THEN 'Friday'\n            WHEN 7 THEN 'Saturday'\n        END AS day_of_week,\n        \n        -- Traffic metrics\n        COUNT(*) AS total_events,\n        COUNT(DISTINCT user_id) AS unique_users,\n        \n        COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS total_views,\n        COUNT(CASE WHEN event_type = 'cart' THEN 1 END) AS total_carts,\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS total_purchases,\n        \n        -- Revenue\n        SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) AS revenue,\n        \n        CURRENT_TIMESTAMP() AS _updated_at\n        \n    FROM silver.silver_ecommerce_events\n    \n    \n    WHERE event_date > (SELECT MAX(event_date) FROM silver_gold.gold_hourly_traffic)\n    \n    \n    GROUP BY event_date, event_hour, day_of_week_num\n)\n\nSELECT * FROM hourly_metrics\nORDER BY event_date, event_hour", "relation_name": "silver_gold.gold_hourly_traffic"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.048260Z", "completed_at": "2026-02-04T13:15:34.060215Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.061511Z", "completed_at": "2026-02-04T13:15:34.061531Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018482685089111328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_product_performance", "compiled": true, "compiled_code": "\n\nWITH product_metrics AS (\n    SELECT\n        product_id,\n        MAX(category_level_1) AS category_level_1,\n        MAX(category_level_2) AS category_level_2,\n        MAX(brand) AS brand,\n        \n        -- Event counts\n        COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS total_views,\n        COUNT(DISTINCT CASE WHEN event_type = 'view' THEN user_id END) AS unique_viewers,\n        \n        COUNT(CASE WHEN event_type = 'cart' THEN 1 END) AS total_carts,\n        COUNT(DISTINCT CASE WHEN event_type = 'cart' THEN user_id END) AS unique_carters,\n        \n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS total_purchases,\n        COUNT(DISTINCT CASE WHEN event_type = 'purchase' THEN user_id END) AS unique_buyers,\n        \n        -- Revenue metrics\n        SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) AS total_revenue,\n        ROUND(AVG(CASE WHEN event_type = 'purchase' THEN price END), 2) AS avg_price,\n        \n        -- Last sold\n        MAX(CASE WHEN event_type = 'purchase' THEN event_date END) AS last_sold_date,\n        \n        CURRENT_TIMESTAMP() AS _updated_at\n        \n    FROM silver.silver_ecommerce_events\n    WHERE product_id IS NOT NULL\n    GROUP BY product_id\n),\n\nwith_conversion_rates AS (\n    SELECT\n        *,\n        \n        -- Conversion rates\n        ROUND(\n            total_carts * 100.0 / NULLIF(total_views, 0),\n            2\n        ) AS view_to_cart_rate,\n        \n        ROUND(\n            total_purchases * 100.0 / NULLIF(total_carts, 0),\n            2\n        ) AS cart_to_purchase_rate,\n        \n        ROUND(\n            total_purchases * 100.0 / NULLIF(total_views, 0),\n            2\n        ) AS overall_conversion_rate,\n        \n        -- Days since last sale\n        DATEDIFF(CURRENT_DATE(), last_sold_date) AS days_since_last_sale\n        \n    FROM product_metrics\n)\n\nSELECT * FROM with_conversion_rates\nWHERE product_id IS NOT NULL\nORDER BY total_revenue DESC", "relation_name": "silver_gold.gold_product_performance"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.066106Z", "completed_at": "2026-02-04T13:15:34.076825Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.077919Z", "completed_at": "2026-02-04T13:15:34.077935Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013962030410766602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_user_journey_funnel", "compiled": true, "compiled_code": "\n\nWITH user_events AS (\n    SELECT\n        user_id,\n        MIN(CASE WHEN event_type = 'view' THEN event_date END) AS first_view_date,\n        MIN(CASE WHEN event_type = 'cart' THEN event_date END) AS first_cart_date,\n        MIN(CASE WHEN event_type = 'purchase' THEN event_date END) AS first_purchase_date,\n        MAX(event_date) AS last_activity_date,\n        \n        -- Stage flags\n        MAX(CASE WHEN event_type = 'view' THEN 1 ELSE 0 END) AS has_viewed,\n        MAX(CASE WHEN event_type = 'cart' THEN 1 ELSE 0 END) AS has_added_to_cart,\n        MAX(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) AS has_purchased,\n        MAX(CASE WHEN event_type = 'remove_from_cart' THEN 1 ELSE 0 END) AS has_removed_from_cart,\n        \n        -- Event counts\n        COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS total_views,\n        COUNT(CASE WHEN event_type = 'cart' THEN 1 END) AS total_carts,\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS total_purchases,\n        COUNT(CASE WHEN event_type = 'remove_from_cart' THEN 1 END) AS total_cart_removals,\n        \n        COUNT(DISTINCT user_session) AS total_sessions,\n        \n        CURRENT_TIMESTAMP() AS _updated_at\n        \n    FROM silver.silver_ecommerce_events\n    WHERE user_id IS NOT NULL\n    GROUP BY user_id\n),\n\nwith_journey_metrics AS (\n    SELECT\n        *,\n        'lifetime' AS analysis_period,\n        \n        -- Time analysis\n        DATEDIFF(first_cart_date, first_view_date) AS days_to_first_cart,\n        DATEDIFF(first_purchase_date, first_view_date) AS days_to_first_purchase,\n        \n        -- Funnel stage\n        CASE\n            WHEN has_purchased = 1 AND total_purchases >= 3 THEN 'repeat_buyer'\n            WHEN has_purchased = 1 THEN 'purchaser'\n            WHEN has_added_to_cart = 1 AND has_purchased = 0 THEN 'cart_abandoner'\n            WHEN has_viewed = 1 AND has_added_to_cart = 0 THEN 'viewer_only'\n            ELSE 'unknown'\n        END AS current_funnel_stage,\n        \n        -- Behavior flags\n        CASE WHEN has_added_to_cart = 1 AND has_purchased = 0 THEN TRUE ELSE FALSE END AS is_cart_abandoner,\n        \n        CASE \n            WHEN has_purchased = 1 AND DATEDIFF(first_purchase_date, first_view_date) <= 0 THEN TRUE \n            ELSE FALSE \n        END AS is_impulse_buyer,\n        \n        CASE WHEN total_views >= 5 THEN TRUE ELSE FALSE END AS is_researcher\n        \n    FROM user_events\n)\n\nSELECT * FROM with_journey_metrics\nWHERE user_id IS NOT NULL\nORDER BY total_purchases DESC, total_views DESC", "relation_name": "silver_gold.gold_user_journey_funnel"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.081770Z", "completed_at": "2026-02-04T13:15:34.092668Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.093814Z", "completed_at": "2026-02-04T13:15:34.093829Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013852596282958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_user_rfm_segments", "compiled": true, "compiled_code": "\n\nWITH user_purchase_history AS (\n    SELECT\n        user_id,\n\n        MIN(CASE WHEN event_type = 'purchase' THEN event_date END) AS first_purchase_date,\n        MAX(CASE WHEN event_type = 'purchase' THEN event_date END) AS last_purchase_date,\n\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS frequency,\n        SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) AS monetary_value,\n\n        COUNT(DISTINCT user_session) AS total_sessions,\n\n        -- Recency (days since last purchase)\n        DATEDIFF(\n            CURRENT_DATE(),\n            MAX(CASE WHEN event_type = 'purchase' THEN event_date END)\n        ) AS recency_days\n\n    FROM silver.silver_ecommerce_events\n    WHERE user_id IS NOT NULL\n    GROUP BY user_id\n    HAVING COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) > 0\n),\n\nrfm_base AS (\n    SELECT\n        *,\n        ROUND(monetary_value / NULLIF(frequency, 0), 2) AS avg_order_value\n    FROM user_purchase_history\n),\n\nrfm_scores AS (\n    SELECT\n        *,\n\n        -- Quantile-based RFM scores (1\u20135)\n        NTILE(5) OVER (ORDER BY recency_days ASC)  AS rfm_recency_score,\n        NTILE(5) OVER (ORDER BY frequency DESC)    AS rfm_frequency_score,\n        NTILE(5) OVER (ORDER BY monetary_value DESC) AS rfm_monetary_score,\n\n        CURRENT_TIMESTAMP() AS _updated_at\n\n    FROM rfm_base\n),\n\nwith_segments AS (\n    SELECT\n        *,\n\n        CASE\n            WHEN rfm_recency_score >= 4\n             AND rfm_frequency_score >= 4\n             AND rfm_monetary_score >= 4\n                THEN 'Champions'\n\n            WHEN rfm_recency_score >= 3\n             AND rfm_frequency_score >= 3\n             AND rfm_monetary_score >= 3\n                THEN 'Loyal Customers'\n\n            WHEN rfm_recency_score >= 4\n             AND rfm_frequency_score <= 2\n                THEN 'Potential Loyalists'\n\n            WHEN rfm_recency_score <= 2\n             AND rfm_frequency_score >= 4\n                THEN 'At Risk'\n\n            WHEN rfm_recency_score <= 2\n             AND rfm_frequency_score >= 3\n             AND rfm_monetary_score >= 4\n                THEN 'Cannot Lose Them'\n\n            WHEN rfm_recency_score <= 2\n             AND rfm_frequency_score <= 2\n                THEN 'Hibernating'\n\n            WHEN rfm_recency_score = 1\n             AND rfm_frequency_score = 1\n                THEN 'Lost'\n\n            ELSE 'New Customers'\n        END AS rfm_segment,\n\n        -- Approximate CLV\n        ROUND(monetary_value * 1.5, 2) AS customer_lifetime_value\n\n    FROM rfm_scores\n)\n\nSELECT *\nFROM with_segments\nORDER BY monetary_value DESC;", "relation_name": "silver_gold.gold_user_rfm_segments"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.097930Z", "completed_at": "2026-02-04T13:15:34.108854Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.109918Z", "completed_at": "2026-02-04T13:15:34.109933Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013874053955078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.accepted_values_silver_ecommerce_events_event_type__view__cart__purchase__remove_from_cart.810b1ee3c5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_type as value_field,\n        count(*) as n_records\n\n    from silver.silver_ecommerce_events\n    group by event_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'view','cart','purchase','remove_from_cart'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.114000Z", "completed_at": "2026-02-04T13:15:34.128858Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.129809Z", "completed_at": "2026-02-04T13:15:34.129821Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017879009246826172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.accepted_values_silver_ecommerce_events_price_bucket__UNKNOWN__0_50__50_100__100_200__200_500__500_.25653bc51f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        price_bucket as value_field,\n        count(*) as n_records\n\n    from silver.silver_ecommerce_events\n    group by price_bucket\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'UNKNOWN','0-50','50-100','100-200','200-500','500+'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.133934Z", "completed_at": "2026-02-04T13:15:34.146580Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.148018Z", "completed_at": "2026-02-04T13:15:34.148038Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016289949417114258, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.accepted_values_silver_ecommerce_events_time_of_day__MORNING__AFTERNOON__EVENING__NIGHT.9dc47128f7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        time_of_day as value_field,\n        count(*) as n_records\n\n    from silver.silver_ecommerce_events\n    group by time_of_day\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'MORNING','AFTERNOON','EVENING','NIGHT'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.152191Z", "completed_at": "2026-02-04T13:15:34.167998Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.169092Z", "completed_at": "2026-02-04T13:15:34.169107Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018805503845214844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.dbt_utils_accepted_range_silver_ecommerce_events_price__True__0.f5d0467db2", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from (select * from silver.silver_ecommerce_events where price IS NOT NULL) dbt_subquery\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not price >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.173121Z", "completed_at": "2026-02-04T13:15:34.183864Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.184996Z", "completed_at": "2026-02-04T13:15:34.185013Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013901472091674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_silver_ecommerce_events_event_date.c7637aa331", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_date\nfrom silver.silver_ecommerce_events\nwhere event_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.188785Z", "completed_at": "2026-02-04T13:15:34.200493Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.201537Z", "completed_at": "2026-02-04T13:15:34.201552Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014513731002807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_silver_ecommerce_events_event_timestamp.528b54341f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_timestamp\nfrom silver.silver_ecommerce_events\nwhere event_timestamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.205263Z", "completed_at": "2026-02-04T13:15:34.219443Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.220795Z", "completed_at": "2026-02-04T13:15:34.220813Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017305850982666016, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_silver_ecommerce_events_event_type.aeab7b2083", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom silver.silver_ecommerce_events\nwhere event_type is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.224836Z", "completed_at": "2026-02-04T13:15:34.236914Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.237995Z", "completed_at": "2026-02-04T13:15:34.238012Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015189647674560547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_silver_ecommerce_events_event_unique_id.9b488ac959", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_unique_id\nfrom silver.silver_ecommerce_events\nwhere event_unique_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.242058Z", "completed_at": "2026-02-04T13:15:34.252806Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.253933Z", "completed_at": "2026-02-04T13:15:34.253949Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013945341110229492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_silver_ecommerce_events_user_id.7e3ec61ff3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom silver.silver_ecommerce_events\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.258617Z", "completed_at": "2026-02-04T13:15:34.272462Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.274016Z", "completed_at": "2026-02-04T13:15:34.274036Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01797962188720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.unique_silver_ecommerce_events_event_unique_id.e29ba4406f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_unique_id as unique_field,\n    count(*) as n_records\n\nfrom silver.silver_ecommerce_events\nwhere event_unique_id is not null\ngroup by event_unique_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.278882Z", "completed_at": "2026-02-04T13:15:34.291524Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.292676Z", "completed_at": "2026-02-04T13:15:34.292693Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0158231258392334, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_category_performance_analysis_date.babadcc448", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect analysis_date\nfrom silver_gold.gold_category_performance\nwhere analysis_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.296284Z", "completed_at": "2026-02-04T13:15:34.307294Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.308389Z", "completed_at": "2026-02-04T13:15:34.308408Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013819694519042969, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_category_performance_category_level_1.392ee2d2e7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category_level_1\nfrom silver_gold.gold_category_performance\nwhere category_level_1 is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.312239Z", "completed_at": "2026-02-04T13:15:34.323185Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.324300Z", "completed_at": "2026-02-04T13:15:34.324317Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013804912567138672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_conversion_funnel_daily_analysis_date.144e1f5bf4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect analysis_date\nfrom silver_gold.gold_conversion_funnel_daily\nwhere analysis_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.328234Z", "completed_at": "2026-02-04T13:15:34.338742Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.339758Z", "completed_at": "2026-02-04T13:15:34.339774Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013381481170654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_conversion_funnel_daily_stage_1_view_users.21566f2c24", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_1_view_users\nfrom silver_gold.gold_conversion_funnel_daily\nwhere stage_1_view_users is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.343385Z", "completed_at": "2026-02-04T13:15:34.354676Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.355728Z", "completed_at": "2026-02-04T13:15:34.355743Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014056205749511719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_daily_sales_summary_sale_date.192b9aa314", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_date\nfrom silver_gold.gold_daily_sales_summary\nwhere sale_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.359371Z", "completed_at": "2026-02-04T13:15:34.429521Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.430927Z", "completed_at": "2026-02-04T13:15:34.430953Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07328438758850098, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_daily_sales_summary_total_revenue.30fa2d5516", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_revenue\nfrom silver_gold.gold_daily_sales_summary\nwhere total_revenue is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.435288Z", "completed_at": "2026-02-04T13:15:34.447447Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.448550Z", "completed_at": "2026-02-04T13:15:34.448566Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015254974365234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.unique_gold_daily_sales_summary_sale_date.a863611ac5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sale_date as unique_field,\n    count(*) as n_records\n\nfrom silver_gold.gold_daily_sales_summary\nwhere sale_date is not null\ngroup by sale_date\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.452313Z", "completed_at": "2026-02-04T13:15:34.463665Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.464704Z", "completed_at": "2026-02-04T13:15:34.464721Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01419210433959961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_hourly_traffic_event_date.97ca746af2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_date\nfrom silver_gold.gold_hourly_traffic\nwhere event_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.468440Z", "completed_at": "2026-02-04T13:15:34.479144Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.480245Z", "completed_at": "2026-02-04T13:15:34.480261Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013598918914794922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_hourly_traffic_event_hour.23ec7e9a6a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_hour\nfrom silver_gold.gold_hourly_traffic\nwhere event_hour is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.484084Z", "completed_at": "2026-02-04T13:15:34.494515Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.495589Z", "completed_at": "2026-02-04T13:15:34.495608Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013350963592529297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_product_performance_product_id.ec7b18d0d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom silver_gold.gold_product_performance\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.499268Z", "completed_at": "2026-02-04T13:15:34.509868Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.510968Z", "completed_at": "2026-02-04T13:15:34.510984Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013429641723632812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.unique_gold_product_performance_product_id.5651a6ccb4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom silver_gold.gold_product_performance\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.514569Z", "completed_at": "2026-02-04T13:15:34.527934Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.529171Z", "completed_at": "2026-02-04T13:15:34.529186Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016270160675048828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.accepted_values_gold_user_journey_funnel_current_funnel_stage__viewer_only__cart_abandoner__purchaser__repeat_buyer__unknown.817797fbd9", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        current_funnel_stage as value_field,\n        count(*) as n_records\n\n    from silver_gold.gold_user_journey_funnel\n    group by current_funnel_stage\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'viewer_only','cart_abandoner','purchaser','repeat_buyer','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.532866Z", "completed_at": "2026-02-04T13:15:34.544995Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.546205Z", "completed_at": "2026-02-04T13:15:34.546223Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015200376510620117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_user_journey_funnel_user_id.b85d4d0253", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom silver_gold.gold_user_journey_funnel\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.550894Z", "completed_at": "2026-02-04T13:15:34.562018Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.563447Z", "completed_at": "2026-02-04T13:15:34.563464Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014890909194946289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.unique_gold_user_journey_funnel_user_id.fdc0f45fbb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom silver_gold.gold_user_journey_funnel\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.568457Z", "completed_at": "2026-02-04T13:15:34.590090Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.591761Z", "completed_at": "2026-02-04T13:15:34.591825Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.025842905044555664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.accepted_values_gold_user_rfm_segments_rfm_segment__Champions__Loyal_Customers__Potential_Loyalists__At_Risk__Cannot_Lose_Them__Hibernating__Lost__New_Customers.e8e754baff", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        rfm_segment as value_field,\n        count(*) as n_records\n\n    from silver_gold.gold_user_rfm_segments\n    group by rfm_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Champions','Loyal Customers','Potential Loyalists','At Risk','Cannot Lose Them','Hibernating','Lost','New Customers'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.602980Z", "completed_at": "2026-02-04T13:15:34.627367Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.629153Z", "completed_at": "2026-02-04T13:15:34.629174Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03002333641052246, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_user_rfm_segments_user_id.a43575bfd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom silver_gold.gold_user_rfm_segments\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-04T13:15:34.636178Z", "completed_at": "2026-02-04T13:15:34.654929Z"}, {"name": "execute", "started_at": "2026-02-04T13:15:34.656268Z", "completed_at": "2026-02-04T13:15:34.656286Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02351999282836914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.unique_gold_user_rfm_segments_user_id.abe1599bb3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom silver_gold.gold_user_rfm_segments\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 1.4509341716766357, "args": {"partial_parse": true, "log_level_file": "debug", "printer_width": 80, "project_dir": "/usr/app/dbt", "show_resource_report": false, "indirect_selection": "eager", "log_file_max_bytes": 10485760, "defer": false, "use_colors": true, "invocation_command": "dbt docs generate", "source_freshness_run_project_hooks": false, "static": false, "which": "generate", "log_format_file": "debug", "profiles_dir": "/usr/app/dbt", "cache_selected_only": false, "compile": true, "require_explicit_package_overrides_for_builtin_materializations": true, "vars": {}, "populate_cache": true, "print": true, "select": [], "send_anonymous_usage_stats": true, "static_parser": true, "version_check": true, "log_level": "info", "warn_error_options": {"include": [], "exclude": []}, "empty_catalog": false, "exclude": [], "write_json": true, "log_path": "/usr/app/dbt/logs", "partial_parse_file_diff": true, "macro_debugging": false, "strict_mode": false, "use_colors_file": true, "require_resource_names_without_spaces": false, "favor_state": false, "introspect": true, "enable_legacy_logger": false, "quiet": false, "log_format": "default"}}