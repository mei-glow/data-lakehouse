{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.2", "generated_at": "2026-02-03T02:58:21.702229Z", "invocation_id": "da094c91-7542-4c63-8431-61ed96923245", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.716830Z", "completed_at": "2026-02-03T02:58:20.743519Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:20.744797Z", "completed_at": "2026-02-03T02:58:20.744827Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03098893165588379, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.silver_ecommerce_events", "compiled": true, "compiled_code": "\n\nWITH source_data AS (\n    SELECT *\n    FROM bronze.ecommerce_events\n    \n    \n    -- Only process new data\n    WHERE _ingestion_time > (SELECT MAX(_bronze_ingestion_time) FROM silver.silver_ecommerce_events)\n    \n),\n\ncleaned_events AS (\n    SELECT\n        -- Generate unique ID\n        MD5(CONCAT(\n            CAST(user_id AS STRING),\n            COALESCE(CAST(product_id AS STRING), 'NULL'),\n            event_type,\n            event_time\n        )) AS event_unique_id,\n        \n        -- Parse timestamp\n        CAST(event_time AS TIMESTAMP) AS event_timestamp,\n        DATE(CAST(event_time AS TIMESTAMP)) AS event_date,\n        HOUR(CAST(event_time AS TIMESTAMP)) AS event_hour,\n        DAYOFWEEK(CAST(event_time AS TIMESTAMP)) AS day_of_week_num,\n        \n        -- Clean event type\n        LOWER(TRIM(event_type)) AS event_type,\n        \n        -- IDs (user_id required, product_id nullable)\n        user_id,\n        TRIM(user_session) AS user_session,\n        product_id,  -- Nullable OK\n        \n        -- Parse category hierarchy\n        CASE \n            WHEN category_code IS NOT NULL THEN SPLIT(category_code, '\\\\.')[0]\n            ELSE NULL \n        END AS category_level_1,\n        \n        CASE \n            WHEN category_code IS NOT NULL AND SIZE(SPLIT(category_code, '\\\\.')) >= 2 \n            THEN SPLIT(category_code, '\\\\.')[1]\n            ELSE NULL \n        END AS category_level_2,\n        \n        CASE \n            WHEN category_code IS NOT NULL AND SIZE(SPLIT(category_code, '\\\\.')) >= 3 \n            THEN SPLIT(category_code, '\\\\.')[2]\n            ELSE NULL \n        END AS category_level_3,\n        \n        -- Standardize brand\n        CASE \n            WHEN brand IS NOT NULL THEN UPPER(TRIM(brand))\n            ELSE NULL \n        END AS brand_standardized,\n        \n        -- Price validation\n        CASE \n            WHEN price IS NULL THEN NULL\n            WHEN price < 0 THEN NULL  -- Invalid prices \u2192 NULL\n            ELSE ROUND(price, 2)\n        END AS price_clean,\n        \n        -- Derived: Price bucket\n        CASE \n            WHEN price IS NULL THEN 'UNKNOWN'\n            WHEN price < 50 THEN '0-50'\n            WHEN price < 100 THEN '50-100'\n            WHEN price < 200 THEN '100-200'\n            WHEN price < 500 THEN '200-500'\n            ELSE '500+'\n        END AS price_bucket,\n        \n        -- Derived: Time of day\n        CASE \n            WHEN HOUR(CAST(event_time AS TIMESTAMP)) >= 6 AND HOUR(CAST(event_time AS TIMESTAMP)) < 12 THEN 'MORNING'\n            WHEN HOUR(CAST(event_time AS TIMESTAMP)) >= 12 AND HOUR(CAST(event_time AS TIMESTAMP)) < 18 THEN 'AFTERNOON'\n            WHEN HOUR(CAST(event_time AS TIMESTAMP)) >= 18 AND HOUR(CAST(event_time AS TIMESTAMP)) < 22 THEN 'EVENING'\n            ELSE 'NIGHT'\n        END AS time_of_day,\n        \n        -- Derived: Is weekend\n        CASE \n            WHEN DAYOFWEEK(CAST(event_time AS TIMESTAMP)) IN (1, 7) THEN TRUE  -- Sunday=1, Saturday=7\n            ELSE FALSE \n        END AS is_weekend,\n        \n        -- Metadata\n        _ingestion_time AS _bronze_ingestion_time,\n        _source_file,\n        CURRENT_TIMESTAMP() AS _silver_processed_at,\n        _processing_date\n        \n    FROM source_data\n    WHERE user_id IS NOT NULL  -- User ID is required\n),\n\n-- Remove duplicates\ndeduped_events AS (\n    SELECT *\n    FROM (\n        SELECT \n            *,\n            ROW_NUMBER() OVER (\n                PARTITION BY event_unique_id \n                ORDER BY _bronze_ingestion_time DESC\n            ) AS row_num\n        FROM cleaned_events\n    ) ranked\n    WHERE row_num = 1\n)\n\nSELECT\n    event_unique_id,\n    event_timestamp,\n    event_date,\n    event_hour,\n    day_of_week_num,\n    \n    event_type,\n    user_id,\n    user_session,\n    product_id,\n    \n    category_level_1,\n    category_level_2,\n    category_level_3,\n    \n    brand_standardized AS brand,\n    price_clean AS price,\n    price_bucket,\n    \n    time_of_day,\n    is_weekend,\n    \n    _bronze_ingestion_time,\n    _source_file,\n    _silver_processed_at,\n    _processing_date\n    \nFROM deduped_events", "relation_name": "silver.silver_ecommerce_events"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.752193Z", "completed_at": "2026-02-03T02:58:20.777261Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:20.778877Z", "completed_at": "2026-02-03T02:58:20.778905Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03025054931640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.source_accepted_values_bronze_ecommerce_events_event_type__view__cart__purchase__remove_from_cart.d8a9c52576", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_type as value_field,\n        count(*) as n_records\n\n    from bronze.ecommerce_events\n    group by event_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'view','cart','purchase','remove_from_cart'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.785166Z", "completed_at": "2026-02-03T02:58:20.807590Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:20.808861Z", "completed_at": "2026-02-03T02:58:20.808884Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026381492614746094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.source_not_null_bronze_ecommerce_events__processing_date.af290b32ef", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect _processing_date\nfrom bronze.ecommerce_events\nwhere _processing_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.813594Z", "completed_at": "2026-02-03T02:58:20.829093Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:20.830676Z", "completed_at": "2026-02-03T02:58:20.830705Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019531965255737305, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.source_not_null_bronze_ecommerce_events_event_time.c9bca3180f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_time\nfrom bronze.ecommerce_events\nwhere event_time is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.835390Z", "completed_at": "2026-02-03T02:58:20.849112Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:20.850440Z", "completed_at": "2026-02-03T02:58:20.850457Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017030000686645508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.source_not_null_bronze_ecommerce_events_event_type.b5d4004f0b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom bronze.ecommerce_events\nwhere event_type is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.855057Z", "completed_at": "2026-02-03T02:58:20.868711Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:20.869937Z", "completed_at": "2026-02-03T02:58:20.869956Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017246007919311523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.source_not_null_bronze_ecommerce_events_user_id.acdc2b663b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom bronze.ecommerce_events\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.874590Z", "completed_at": "2026-02-03T02:58:20.887999Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:20.889373Z", "completed_at": "2026-02-03T02:58:20.889394Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016939878463745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_category_performance", "compiled": true, "compiled_code": "\n\n-- 1\ufe0f\u20e3 Daily category metrics\nWITH category_daily AS (\n    SELECT\n        event_date AS analysis_date,\n        category_level_1,\n        category_level_2,\n        \n        -- Revenue metrics\n        SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) AS total_revenue,\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS total_orders,\n        COUNT(DISTINCT CASE WHEN event_type = 'purchase' THEN user_id END) AS unique_customers,\n        \n        ROUND(\n            SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) /\n            NULLIF(COUNT(CASE WHEN event_type = 'purchase' THEN 1 END), 0),\n            2\n        ) AS avg_order_value,\n        \n        CURRENT_TIMESTAMP() AS _updated_at\n        \n    FROM silver.silver_ecommerce_events\n    WHERE category_level_1 IS NOT NULL\n    \n    \n    AND event_date > (SELECT MAX(analysis_date) FROM silver_gold.gold_category_performance)\n    \n    \n    GROUP BY event_date, category_level_1, category_level_2\n),\n\n-- 2\ufe0f\u20e3 Brand revenue per day per category\nbrand_daily_revenue AS (\n    SELECT\n        event_date AS analysis_date,\n        category_level_1,\n        category_level_2,\n        brand,\n        SUM(price) AS brand_revenue\n    FROM silver.silver_ecommerce_events\n    WHERE event_type = 'purchase'\n      AND brand IS NOT NULL\n      AND category_level_1 IS NOT NULL\n    GROUP BY event_date, category_level_1, category_level_2, brand\n),\n\n-- 3\ufe0f\u20e3 Rank brands by revenue\nranked_brands AS (\n    SELECT\n        *,\n        ROW_NUMBER() OVER (\n            PARTITION BY analysis_date, category_level_1, category_level_2\n            ORDER BY brand_revenue DESC\n        ) AS brand_rank\n    FROM brand_daily_revenue\n),\n\n-- 4\ufe0f\u20e3 Pick top brand per category per day\ntop_brand_per_category AS (\n    SELECT\n        analysis_date,\n        category_level_1,\n        category_level_2,\n        brand AS top_brand,\n        brand_revenue AS top_brand_revenue\n    FROM ranked_brands\n    WHERE brand_rank = 1\n)\n\n-- 5\ufe0f\u20e3 Final output\nSELECT\n    cd.*,\n    tb.top_brand,\n    tb.top_brand_revenue\nFROM category_daily cd\nLEFT JOIN top_brand_per_category tb\n  ON cd.analysis_date = tb.analysis_date\n AND cd.category_level_1 = tb.category_level_1\n AND cd.category_level_2 = tb.category_level_2\nORDER BY cd.analysis_date, cd.total_revenue DESC", "relation_name": "silver_gold.gold_category_performance"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.894688Z", "completed_at": "2026-02-03T02:58:20.908913Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:20.910055Z", "completed_at": "2026-02-03T02:58:20.910076Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01793670654296875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_conversion_funnel_daily", "compiled": true, "compiled_code": "\n\nWITH funnel_metrics AS (\n    SELECT\n        event_date AS analysis_date,\n        category_level_1,\n        category_level_2,\n        time_of_day,\n        is_weekend,\n        \n        -- Unique users per stage\n        COUNT(DISTINCT CASE WHEN event_type = 'view' THEN user_id END) AS stage_1_view_users,\n        COUNT(DISTINCT CASE WHEN event_type = 'cart' THEN user_id END) AS stage_2_cart_users,\n        COUNT(DISTINCT CASE WHEN event_type = 'purchase' THEN user_id END) AS stage_3_purchase_users,\n        \n        -- Total events per stage\n        COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS stage_1_view_events,\n        COUNT(CASE WHEN event_type = 'cart' THEN 1 END) AS stage_2_cart_events,\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS stage_3_purchase_events,\n        \n        -- Revenue\n        SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) AS total_revenue,\n        \n        CURRENT_TIMESTAMP() AS _updated_at\n        \n    FROM silver.silver_ecommerce_events\n    \n    \n    WHERE event_date > (SELECT MAX(analysis_date) FROM silver_gold.gold_conversion_funnel_daily)\n    \n    \n    GROUP BY event_date, category_level_1, category_level_2, time_of_day, is_weekend\n),\n\nwith_rates AS (\n    SELECT\n        *,\n        \n        -- Conversion rates\n        ROUND(\n            stage_2_cart_users * 100.0 / NULLIF(stage_1_view_users, 0),\n            2\n        ) AS view_to_cart_rate,\n        \n        ROUND(\n            stage_3_purchase_users * 100.0 / NULLIF(stage_2_cart_users, 0),\n            2\n        ) AS cart_to_purchase_rate,\n        \n        ROUND(\n            stage_3_purchase_users * 100.0 / NULLIF(stage_1_view_users, 0),\n            2\n        ) AS overall_conversion_rate,\n        \n        -- Drop-offs\n        (stage_1_view_users - stage_2_cart_users) AS dropoff_after_view,\n        (stage_2_cart_users - stage_3_purchase_users) AS dropoff_after_cart,\n        \n        ROUND(\n            (stage_1_view_users - stage_2_cart_users) * 100.0 / NULLIF(stage_1_view_users, 0),\n            2\n        ) AS dropoff_rate_view,\n        \n        ROUND(\n            (stage_2_cart_users - stage_3_purchase_users) * 100.0 / NULLIF(stage_2_cart_users, 0),\n            2\n        ) AS dropoff_rate_cart,\n        \n        -- Revenue metrics\n        ROUND(\n            total_revenue / NULLIF(stage_3_purchase_users, 0),\n            2\n        ) AS avg_order_value,\n        \n        ROUND(\n            total_revenue / NULLIF(stage_1_view_users, 0),\n            2\n        ) AS revenue_per_viewer\n        \n    FROM funnel_metrics\n)\n\nSELECT * FROM with_rates\nWHERE stage_1_view_users > 0\nORDER BY analysis_date, total_revenue DESC", "relation_name": "silver_gold.gold_conversion_funnel_daily"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.915748Z", "completed_at": "2026-02-03T02:58:20.928436Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:20.929682Z", "completed_at": "2026-02-03T02:58:20.929703Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017068862915039062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_daily_sales_summary", "compiled": true, "compiled_code": "\n\nWITH daily_metrics AS (\n    SELECT\n        event_date AS sale_date,\n        \n        -- Revenue metrics\n        SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) AS total_revenue,\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS total_orders,\n        COUNT(DISTINCT CASE WHEN event_type = 'purchase' THEN user_id END) AS unique_customers,\n        \n        -- Average order value\n        ROUND(\n            SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) / \n            NULLIF(COUNT(CASE WHEN event_type = 'purchase' THEN 1 END), 0),\n            2\n        ) AS avg_order_value,\n        \n        -- Items purchased\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS total_items_purchased,\n        \n        -- Traffic metrics\n        COUNT(DISTINCT CASE WHEN event_type = 'view' THEN user_id END) AS unique_viewers,\n        COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS total_views,\n        COUNT(CASE WHEN event_type = 'cart' THEN 1 END) AS total_carts,\n        \n        -- Conversion rates\n        ROUND(\n            COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) * 100.0 / \n            NULLIF(COUNT(CASE WHEN event_type = 'view' THEN 1 END), 0),\n            2\n        ) AS conversion_rate,\n        \n        ROUND(\n            (COUNT(CASE WHEN event_type = 'cart' THEN 1 END) - \n             COUNT(CASE WHEN event_type = 'purchase' THEN 1 END)) * 100.0 / \n            NULLIF(COUNT(CASE WHEN event_type = 'cart' THEN 1 END), 0),\n            2\n        ) AS cart_abandonment_rate,\n        \n        CURRENT_TIMESTAMP() AS _updated_at\n        \n    FROM silver.silver_ecommerce_events\n    \n    \n    WHERE event_date > (SELECT MAX(sale_date) FROM silver_gold.gold_daily_sales_summary)\n    \n    \n    GROUP BY event_date\n)\n\nSELECT * FROM daily_metrics\nORDER BY sale_date", "relation_name": "silver_gold.gold_daily_sales_summary"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.935149Z", "completed_at": "2026-02-03T02:58:20.949638Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:20.950810Z", "completed_at": "2026-02-03T02:58:20.950827Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017894983291625977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_hourly_traffic", "compiled": true, "compiled_code": "\n\nWITH hourly_metrics AS (\n    SELECT\n        event_date,\n        event_hour,\n        \n        -- Day info\n        CASE day_of_week_num\n            WHEN 1 THEN 'Sunday'\n            WHEN 2 THEN 'Monday'\n            WHEN 3 THEN 'Tuesday'\n            WHEN 4 THEN 'Wednesday'\n            WHEN 5 THEN 'Thursday'\n            WHEN 6 THEN 'Friday'\n            WHEN 7 THEN 'Saturday'\n        END AS day_of_week,\n        \n        -- Traffic metrics\n        COUNT(*) AS total_events,\n        COUNT(DISTINCT user_id) AS unique_users,\n        \n        COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS total_views,\n        COUNT(CASE WHEN event_type = 'cart' THEN 1 END) AS total_carts,\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS total_purchases,\n        \n        -- Revenue\n        SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) AS revenue,\n        \n        CURRENT_TIMESTAMP() AS _updated_at\n        \n    FROM silver.silver_ecommerce_events\n    \n    \n    WHERE event_date > (SELECT MAX(event_date) FROM silver_gold.gold_hourly_traffic)\n    \n    \n    GROUP BY event_date, event_hour, day_of_week_num\n)\n\nSELECT * FROM hourly_metrics\nORDER BY event_date, event_hour", "relation_name": "silver_gold.gold_hourly_traffic"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.955482Z", "completed_at": "2026-02-03T02:58:20.968142Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:20.969360Z", "completed_at": "2026-02-03T02:58:20.969378Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016218185424804688, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_product_performance", "compiled": true, "compiled_code": "\n\nWITH product_metrics AS (\n    SELECT\n        product_id,\n        MAX(category_level_1) AS category_level_1,\n        MAX(category_level_2) AS category_level_2,\n        MAX(brand) AS brand,\n        \n        -- Event counts\n        COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS total_views,\n        COUNT(DISTINCT CASE WHEN event_type = 'view' THEN user_id END) AS unique_viewers,\n        \n        COUNT(CASE WHEN event_type = 'cart' THEN 1 END) AS total_carts,\n        COUNT(DISTINCT CASE WHEN event_type = 'cart' THEN user_id END) AS unique_carters,\n        \n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS total_purchases,\n        COUNT(DISTINCT CASE WHEN event_type = 'purchase' THEN user_id END) AS unique_buyers,\n        \n        -- Revenue metrics\n        SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) AS total_revenue,\n        ROUND(AVG(CASE WHEN event_type = 'purchase' THEN price END), 2) AS avg_price,\n        \n        -- Last sold\n        MAX(CASE WHEN event_type = 'purchase' THEN event_date END) AS last_sold_date,\n        \n        CURRENT_TIMESTAMP() AS _updated_at\n        \n    FROM silver.silver_ecommerce_events\n    WHERE product_id IS NOT NULL\n    GROUP BY product_id\n),\n\nwith_conversion_rates AS (\n    SELECT\n        *,\n        \n        -- Conversion rates\n        ROUND(\n            total_carts * 100.0 / NULLIF(total_views, 0),\n            2\n        ) AS view_to_cart_rate,\n        \n        ROUND(\n            total_purchases * 100.0 / NULLIF(total_carts, 0),\n            2\n        ) AS cart_to_purchase_rate,\n        \n        ROUND(\n            total_purchases * 100.0 / NULLIF(total_views, 0),\n            2\n        ) AS overall_conversion_rate,\n        \n        -- Days since last sale\n        DATEDIFF(CURRENT_DATE(), last_sold_date) AS days_since_last_sale\n        \n    FROM product_metrics\n)\n\nSELECT * FROM with_conversion_rates\nWHERE product_id IS NOT NULL\nORDER BY total_revenue DESC", "relation_name": "silver_gold.gold_product_performance"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.973556Z", "completed_at": "2026-02-03T02:58:20.984729Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:20.986190Z", "completed_at": "2026-02-03T02:58:20.986207Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014498472213745117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_user_journey_funnel", "compiled": true, "compiled_code": "\n\nWITH user_events AS (\n    SELECT\n        user_id,\n        MIN(CASE WHEN event_type = 'view' THEN event_date END) AS first_view_date,\n        MIN(CASE WHEN event_type = 'cart' THEN event_date END) AS first_cart_date,\n        MIN(CASE WHEN event_type = 'purchase' THEN event_date END) AS first_purchase_date,\n        MAX(event_date) AS last_activity_date,\n        \n        -- Stage flags\n        MAX(CASE WHEN event_type = 'view' THEN 1 ELSE 0 END) AS has_viewed,\n        MAX(CASE WHEN event_type = 'cart' THEN 1 ELSE 0 END) AS has_added_to_cart,\n        MAX(CASE WHEN event_type = 'purchase' THEN 1 ELSE 0 END) AS has_purchased,\n        MAX(CASE WHEN event_type = 'remove_from_cart' THEN 1 ELSE 0 END) AS has_removed_from_cart,\n        \n        -- Event counts\n        COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS total_views,\n        COUNT(CASE WHEN event_type = 'cart' THEN 1 END) AS total_carts,\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS total_purchases,\n        COUNT(CASE WHEN event_type = 'remove_from_cart' THEN 1 END) AS total_cart_removals,\n        \n        COUNT(DISTINCT user_session) AS total_sessions,\n        \n        CURRENT_TIMESTAMP() AS _updated_at\n        \n    FROM silver.silver_ecommerce_events\n    WHERE user_id IS NOT NULL\n    GROUP BY user_id\n),\n\nwith_journey_metrics AS (\n    SELECT\n        *,\n        'lifetime' AS analysis_period,\n        \n        -- Time analysis\n        DATEDIFF(first_cart_date, first_view_date) AS days_to_first_cart,\n        DATEDIFF(first_purchase_date, first_view_date) AS days_to_first_purchase,\n        \n        -- Funnel stage\n        CASE\n            WHEN has_purchased = 1 AND total_purchases >= 3 THEN 'repeat_buyer'\n            WHEN has_purchased = 1 THEN 'purchaser'\n            WHEN has_added_to_cart = 1 AND has_purchased = 0 THEN 'cart_abandoner'\n            WHEN has_viewed = 1 AND has_added_to_cart = 0 THEN 'viewer_only'\n            ELSE 'unknown'\n        END AS current_funnel_stage,\n        \n        -- Behavior flags\n        CASE WHEN has_added_to_cart = 1 AND has_purchased = 0 THEN TRUE ELSE FALSE END AS is_cart_abandoner,\n        \n        CASE \n            WHEN has_purchased = 1 AND DATEDIFF(first_purchase_date, first_view_date) <= 0 THEN TRUE \n            ELSE FALSE \n        END AS is_impulse_buyer,\n        \n        CASE WHEN total_views >= 5 THEN TRUE ELSE FALSE END AS is_researcher\n        \n    FROM user_events\n)\n\nSELECT * FROM with_journey_metrics\nWHERE user_id IS NOT NULL\nORDER BY total_purchases DESC, total_views DESC", "relation_name": "silver_gold.gold_user_journey_funnel"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:20.990094Z", "completed_at": "2026-02-03T02:58:21.001076Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.002404Z", "completed_at": "2026-02-03T02:58:21.002422Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0140533447265625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.ecommerce_lakehouse.gold_user_rfm_segments", "compiled": true, "compiled_code": "\n\nWITH user_purchase_history AS (\n    SELECT\n        user_id,\n\n        MIN(CASE WHEN event_type = 'purchase' THEN event_date END) AS first_purchase_date,\n        MAX(CASE WHEN event_type = 'purchase' THEN event_date END) AS last_purchase_date,\n\n        COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) AS frequency,\n        SUM(CASE WHEN event_type = 'purchase' THEN price ELSE 0 END) AS monetary_value,\n\n        COUNT(DISTINCT user_session) AS total_sessions,\n\n        -- Recency (days since last purchase)\n        DATEDIFF(\n            CURRENT_DATE(),\n            MAX(CASE WHEN event_type = 'purchase' THEN event_date END)\n        ) AS recency_days\n\n    FROM silver.silver_ecommerce_events\n    WHERE user_id IS NOT NULL\n    GROUP BY user_id\n    HAVING COUNT(CASE WHEN event_type = 'purchase' THEN 1 END) > 0\n),\n\nrfm_base AS (\n    SELECT\n        *,\n        ROUND(monetary_value / NULLIF(frequency, 0), 2) AS avg_order_value\n    FROM user_purchase_history\n),\n\nrfm_scores AS (\n    SELECT\n        *,\n\n        -- Quantile-based RFM scores (1\u20135)\n        NTILE(5) OVER (ORDER BY recency_days ASC)  AS rfm_recency_score,\n        NTILE(5) OVER (ORDER BY frequency DESC)    AS rfm_frequency_score,\n        NTILE(5) OVER (ORDER BY monetary_value DESC) AS rfm_monetary_score,\n\n        CURRENT_TIMESTAMP() AS _updated_at\n\n    FROM rfm_base\n),\n\nwith_segments AS (\n    SELECT\n        *,\n\n        CASE\n            WHEN rfm_recency_score >= 4\n             AND rfm_frequency_score >= 4\n             AND rfm_monetary_score >= 4\n                THEN 'Champions'\n\n            WHEN rfm_recency_score >= 3\n             AND rfm_frequency_score >= 3\n             AND rfm_monetary_score >= 3\n                THEN 'Loyal Customers'\n\n            WHEN rfm_recency_score >= 4\n             AND rfm_frequency_score <= 2\n                THEN 'Potential Loyalists'\n\n            WHEN rfm_recency_score <= 2\n             AND rfm_frequency_score >= 4\n                THEN 'At Risk'\n\n            WHEN rfm_recency_score <= 2\n             AND rfm_frequency_score >= 3\n             AND rfm_monetary_score >= 4\n                THEN 'Cannot Lose Them'\n\n            WHEN rfm_recency_score <= 2\n             AND rfm_frequency_score <= 2\n                THEN 'Hibernating'\n\n            WHEN rfm_recency_score = 1\n             AND rfm_frequency_score = 1\n                THEN 'Lost'\n\n            ELSE 'New Customers'\n        END AS rfm_segment,\n\n        -- Approximate CLV\n        ROUND(monetary_value * 1.5, 2) AS customer_lifetime_value\n\n    FROM rfm_scores\n)\n\nSELECT *\nFROM with_segments\nORDER BY monetary_value DESC;", "relation_name": "silver_gold.gold_user_rfm_segments"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.006942Z", "completed_at": "2026-02-03T02:58:21.019546Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.020760Z", "completed_at": "2026-02-03T02:58:21.020777Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016002416610717773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.accepted_values_silver_ecommerce_events_event_type__view__cart__purchase__remove_from_cart.810b1ee3c5", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        event_type as value_field,\n        count(*) as n_records\n\n    from silver.silver_ecommerce_events\n    group by event_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'view','cart','purchase','remove_from_cart'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.027498Z", "completed_at": "2026-02-03T02:58:21.045279Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.046498Z", "completed_at": "2026-02-03T02:58:21.046527Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02155280113220215, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.accepted_values_silver_ecommerce_events_price_bucket__UNKNOWN__0_50__50_100__100_200__200_500__500_.25653bc51f", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        price_bucket as value_field,\n        count(*) as n_records\n\n    from silver.silver_ecommerce_events\n    group by price_bucket\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'UNKNOWN','0-50','50-100','100-200','200-500','500+'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.050430Z", "completed_at": "2026-02-03T02:58:21.063407Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.065021Z", "completed_at": "2026-02-03T02:58:21.065039Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016483306884765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.accepted_values_silver_ecommerce_events_time_of_day__MORNING__AFTERNOON__EVENING__NIGHT.9dc47128f7", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        time_of_day as value_field,\n        count(*) as n_records\n\n    from silver.silver_ecommerce_events\n    group by time_of_day\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'MORNING','AFTERNOON','EVENING','NIGHT'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.068908Z", "completed_at": "2026-02-03T02:58:21.086414Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.087596Z", "completed_at": "2026-02-03T02:58:21.087616Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0205380916595459, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.dbt_utils_accepted_range_silver_ecommerce_events_price__True__0.f5d0467db2", "compiled": true, "compiled_code": "\n\nwith meet_condition as(\n  select *\n  from (select * from silver.silver_ecommerce_events where price IS NOT NULL) dbt_subquery\n),\n\nvalidation_errors as (\n  select *\n  from meet_condition\n  where\n    -- never true, defaults to an empty result set. Exists to ensure any combo of the `or` clauses below succeeds\n    1 = 2\n    -- records with a value >= min_value are permitted. The `not` flips this to find records that don't meet the rule.\n    or not price >= 0\n)\n\nselect *\nfrom validation_errors\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.091965Z", "completed_at": "2026-02-03T02:58:21.137364Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.138830Z", "completed_at": "2026-02-03T02:58:21.138849Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04886031150817871, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_silver_ecommerce_events_event_date.c7637aa331", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_date\nfrom silver.silver_ecommerce_events\nwhere event_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.144594Z", "completed_at": "2026-02-03T02:58:21.160172Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.161483Z", "completed_at": "2026-02-03T02:58:21.161499Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01988387107849121, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_silver_ecommerce_events_event_timestamp.528b54341f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_timestamp\nfrom silver.silver_ecommerce_events\nwhere event_timestamp is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.166335Z", "completed_at": "2026-02-03T02:58:21.176642Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.177871Z", "completed_at": "2026-02-03T02:58:21.177957Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013651132583618164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_silver_ecommerce_events_event_type.aeab7b2083", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_type\nfrom silver.silver_ecommerce_events\nwhere event_type is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.183076Z", "completed_at": "2026-02-03T02:58:21.195304Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.196699Z", "completed_at": "2026-02-03T02:58:21.196716Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.015873432159423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_silver_ecommerce_events_event_unique_id.9b488ac959", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_unique_id\nfrom silver.silver_ecommerce_events\nwhere event_unique_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.200659Z", "completed_at": "2026-02-03T02:58:21.212745Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.214548Z", "completed_at": "2026-02-03T02:58:21.214564Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01563739776611328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_silver_ecommerce_events_user_id.7e3ec61ff3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom silver.silver_ecommerce_events\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.218448Z", "completed_at": "2026-02-03T02:58:21.239234Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.241792Z", "completed_at": "2026-02-03T02:58:21.241812Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02526545524597168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.unique_silver_ecommerce_events_event_unique_id.e29ba4406f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    event_unique_id as unique_field,\n    count(*) as n_records\n\nfrom silver.silver_ecommerce_events\nwhere event_unique_id is not null\ngroup by event_unique_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.246809Z", "completed_at": "2026-02-03T02:58:21.258071Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.259243Z", "completed_at": "2026-02-03T02:58:21.259259Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01506185531616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_category_performance_analysis_date.babadcc448", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect analysis_date\nfrom silver_gold.gold_category_performance\nwhere analysis_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.263900Z", "completed_at": "2026-02-03T02:58:21.283318Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.284636Z", "completed_at": "2026-02-03T02:58:21.284655Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022853851318359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_category_performance_category_level_1.392ee2d2e7", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect category_level_1\nfrom silver_gold.gold_category_performance\nwhere category_level_1 is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.288908Z", "completed_at": "2026-02-03T02:58:21.304121Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.305321Z", "completed_at": "2026-02-03T02:58:21.305336Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.018407344818115234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_conversion_funnel_daily_analysis_date.144e1f5bf4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect analysis_date\nfrom silver_gold.gold_conversion_funnel_daily\nwhere analysis_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.309340Z", "completed_at": "2026-02-03T02:58:21.321017Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.322304Z", "completed_at": "2026-02-03T02:58:21.322319Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014943599700927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_conversion_funnel_daily_stage_1_view_users.21566f2c24", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect stage_1_view_users\nfrom silver_gold.gold_conversion_funnel_daily\nwhere stage_1_view_users is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.326603Z", "completed_at": "2026-02-03T02:58:21.342748Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.344150Z", "completed_at": "2026-02-03T02:58:21.344177Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019762516021728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_daily_sales_summary_sale_date.192b9aa314", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sale_date\nfrom silver_gold.gold_daily_sales_summary\nwhere sale_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.350184Z", "completed_at": "2026-02-03T02:58:21.418160Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.419759Z", "completed_at": "2026-02-03T02:58:21.419779Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.07240700721740723, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_daily_sales_summary_total_revenue.30fa2d5516", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect total_revenue\nfrom silver_gold.gold_daily_sales_summary\nwhere total_revenue is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.425285Z", "completed_at": "2026-02-03T02:58:21.440350Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.441936Z", "completed_at": "2026-02-03T02:58:21.441954Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.019249916076660156, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.unique_gold_daily_sales_summary_sale_date.a863611ac5", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sale_date as unique_field,\n    count(*) as n_records\n\nfrom silver_gold.gold_daily_sales_summary\nwhere sale_date is not null\ngroup by sale_date\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.448182Z", "completed_at": "2026-02-03T02:58:21.467245Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.469269Z", "completed_at": "2026-02-03T02:58:21.469295Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.023851871490478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_hourly_traffic_event_date.97ca746af2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_date\nfrom silver_gold.gold_hourly_traffic\nwhere event_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.476360Z", "completed_at": "2026-02-03T02:58:21.506519Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.510021Z", "completed_at": "2026-02-03T02:58:21.510055Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.03785109519958496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_hourly_traffic_event_hour.23ec7e9a6a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect event_hour\nfrom silver_gold.gold_hourly_traffic\nwhere event_hour is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.518453Z", "completed_at": "2026-02-03T02:58:21.539992Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.541423Z", "completed_at": "2026-02-03T02:58:21.541442Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.026445627212524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_product_performance_product_id.ec7b18d0d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom silver_gold.gold_product_performance\nwhere product_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.549912Z", "completed_at": "2026-02-03T02:58:21.565095Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.566483Z", "completed_at": "2026-02-03T02:58:21.566501Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.021871089935302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.unique_gold_product_performance_product_id.5651a6ccb4", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_id as unique_field,\n    count(*) as n_records\n\nfrom silver_gold.gold_product_performance\nwhere product_id is not null\ngroup by product_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.571888Z", "completed_at": "2026-02-03T02:58:21.590331Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.591755Z", "completed_at": "2026-02-03T02:58:21.591775Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022427797317504883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.accepted_values_gold_user_journey_funnel_current_funnel_stage__viewer_only__cart_abandoner__purchaser__repeat_buyer__unknown.817797fbd9", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        current_funnel_stage as value_field,\n        count(*) as n_records\n\n    from silver_gold.gold_user_journey_funnel\n    group by current_funnel_stage\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'viewer_only','cart_abandoner','purchaser','repeat_buyer','unknown'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.597313Z", "completed_at": "2026-02-03T02:58:21.611152Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.612482Z", "completed_at": "2026-02-03T02:58:21.612499Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01749134063720703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_user_journey_funnel_user_id.b85d4d0253", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom silver_gold.gold_user_journey_funnel\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.616801Z", "completed_at": "2026-02-03T02:58:21.629799Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.631228Z", "completed_at": "2026-02-03T02:58:21.631247Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01642632484436035, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.unique_gold_user_journey_funnel_user_id.fdc0f45fbb", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom silver_gold.gold_user_journey_funnel\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.636064Z", "completed_at": "2026-02-03T02:58:21.655392Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.656820Z", "completed_at": "2026-02-03T02:58:21.656839Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.022997379302978516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.accepted_values_gold_user_rfm_segments_rfm_segment__Champions__Loyal_Customers__Potential_Loyalists__At_Risk__Cannot_Lose_Them__Hibernating__Lost__New_Customers.e8e754baff", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        rfm_segment as value_field,\n        count(*) as n_records\n\n    from silver_gold.gold_user_rfm_segments\n    group by rfm_segment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Champions','Loyal Customers','Potential Loyalists','At Risk','Cannot Lose Them','Hibernating','Lost','New Customers'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.662123Z", "completed_at": "2026-02-03T02:58:21.674772Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.676276Z", "completed_at": "2026-02-03T02:58:21.676299Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01702427864074707, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.not_null_gold_user_rfm_segments_user_id.a43575bfd1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect user_id\nfrom silver_gold.gold_user_rfm_segments\nwhere user_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2026-02-03T02:58:21.681306Z", "completed_at": "2026-02-03T02:58:21.695367Z"}, {"name": "execute", "started_at": "2026-02-03T02:58:21.696638Z", "completed_at": "2026-02-03T02:58:21.696657Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017618179321289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.ecommerce_lakehouse.unique_gold_user_rfm_segments_user_id.abe1599bb3", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    user_id as unique_field,\n    count(*) as n_records\n\nfrom silver_gold.gold_user_rfm_segments\nwhere user_id is not null\ngroup by user_id\nhaving count(*) > 1\n\n\n", "relation_name": null}], "elapsed_time": 1.5496413707733154, "args": {"defer": false, "log_path": "/usr/app/dbt/logs", "use_colors_file": true, "project_dir": "/usr/app/dbt", "log_format_file": "debug", "invocation_command": "dbt docs generate", "profiles_dir": "/usr/app/dbt", "send_anonymous_usage_stats": true, "exclude": [], "log_level": "info", "empty_catalog": false, "printer_width": 80, "compile": true, "static": false, "version_check": true, "favor_state": false, "populate_cache": true, "print": true, "quiet": false, "cache_selected_only": false, "macro_debugging": false, "require_resource_names_without_spaces": false, "require_explicit_package_overrides_for_builtin_materializations": true, "indirect_selection": "eager", "use_colors": true, "introspect": true, "write_json": true, "vars": {}, "log_format": "default", "partial_parse_file_diff": true, "show_resource_report": false, "which": "generate", "log_file_max_bytes": 10485760, "enable_legacy_logger": false, "partial_parse": true, "strict_mode": false, "select": [], "log_level_file": "debug", "static_parser": true, "source_freshness_run_project_hooks": false, "warn_error_options": {"include": [], "exclude": []}}}